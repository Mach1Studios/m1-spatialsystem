<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mach1 Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Base styles */
        :root {
            --mach1-yellow: #FFC61E;
            --mach1-yellow-dark: #e6b100;
            --mach1-yellow-light: #ffd24d;
            --dark-bg: #121212;
            --dark-bg-lighter: #1a1a1a;
            --dark-bg-lightest: #2a2a2a;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --text-muted: #888888;
            --border-color: #333333;
            --accent-color: var(--mach1-yellow);
            --transition-speed: 0.3s;
            --sidebar-width: 270px;
            --toc-width: 250px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--dark-bg);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        /* Layout */
        .container {
            display: flex;
            flex: 1;
        }
        
        /* New TOC Sidebar */
        .toc-sidebar {
            width: var(--toc-width);
            background-color: var(--dark-bg-lightest);
            padding: 30px 0;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            border-right: 1px solid var(--border-color);
            z-index: 10;
            scrollbar-width: thin;
            scrollbar-color: var(--border-color) var(--dark-bg-lightest);
            display: block;
        }
        
        .toc-sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .toc-sidebar::-webkit-scrollbar-track {
            background: var(--dark-bg-lightest);
        }
        
        .toc-sidebar::-webkit-scrollbar-thumb {
            background-color: var(--border-color);
            border-radius: 6px;
        }
        
        .toc-sidebar-inner {
            padding: 0 15px;
        }
        
        .toc-sidebar h3 {
            color: var(--accent-color);
            font-size: 1.3rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
        }
        
        .toc-sidebar h3::before {
            content: '\f02e';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            margin-right: 10px;
            color: var(--accent-color);
        }
        
        .toc-sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .toc-sidebar li {
            margin-bottom: 4px;
        }
        
        .toc-sidebar a {
            display: block;
            padding: 6px 10px;
            text-decoration: none;
            color: var(--text-primary);
            border-left: 3px solid transparent;
            transition: all var(--transition-speed);
            font-size: 0.95rem;
            position: relative;
        }
        
        .toc-sidebar a:hover, 
        .toc-sidebar a.active {
            background-color: rgba(255, 193, 7, 0.15);
            border-left: 3px solid var(--accent-color);
            transform: translateX(5px);
            font-weight: bold;
        }
        
        /* Make active link stand out more */
        .toc-sidebar a.active {
            background-color: rgba(255, 193, 7, 0.25);
            color: var(--accent-color);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .toc-sidebar a::after {
            content: '\f054';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 0.7rem;
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-color);
            opacity: 0;
            transition: opacity var(--transition-speed);
        }
        
        .toc-sidebar a:hover::after {
            opacity: 1;
        }
        
        /* Add accordion styling */
        .toc-sidebar .has-submenu {
            margin-bottom: 8px;
        }
        
        .toc-sidebar .has-submenu > a {
            font-weight: 600;
            background-color: rgba(255, 193, 7, 0.05);
            border-radius: 4px;
        }
        
        .toc-sidebar .has-submenu > a::after {
            content: '\f078'; /* Chevron down */
            opacity: 1;
        }
        
        .toc-sidebar .has-submenu.collapsed > a::after {
            content: '\f054'; /* Chevron right */
            opacity: 1;
        }
        
        .toc-sidebar .has-submenu:not(.collapsed) > a {
            font-weight: bold;
            color: var(--accent-color);
            background-color: rgba(255, 193, 7, 0.1);
        }
        
        .toc-sidebar ul ul {
            padding-left: 10px;
            max-height: 1000px;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        
        .toc-sidebar ul ul ul {
            padding-left: 15px;
            font-size: 0.9em;
        }
        
        .toc-sidebar .collapsed > ul {
            max-height: 0;
        }
        
        .toc-sidebar li.has-submenu > a {
            cursor: pointer;
        }
        
        /* Style top-level sections */
        .toc-sidebar > .toc-sidebar-inner > ul > li.has-submenu {
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 193, 7, 0.1);
            padding-bottom: 10px;
        }
        
        .toc-sidebar > .toc-sidebar-inner > ul > li.has-submenu > a {
            font-size: 1.05rem;
            padding: 8px 10px;
            background-color: rgba(255, 193, 7, 0.08);
            border-radius: 4px;
        }
        
        .toc-sidebar > .toc-sidebar-inner > ul > li.has-submenu > a:hover {
            background-color: rgba(255, 193, 7, 0.15);
        }
        
        .toc-sidebar > .toc-sidebar-inner > ul > li.has-submenu:not(.collapsed) > a {
            background-color: rgba(255, 193, 7, 0.2);
        }
        
        .main-content {
            flex: 1;
            background-color: var(--dark-bg-lighter);
            padding: 40px;
            min-height: 100vh;
            box-sizing: border-box;
            margin-left: var(--toc-width);
        }
        
        /* Header area */
        .header {
            background-color: var(--dark-bg-lighter);
            padding: 40px;
        }
        
        /* Product sections */
        .product-section {
            margin-bottom: 40px;
        }
        
        .product-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            position: relative;
            display: flex;
            align-items: baseline;
            color: var(--accent-color);
            letter-spacing: 0.5px;
        }
        
        .product-title .tm {
            font-size: 0.7rem;
            vertical-align: super;
            margin-left: 2px;
            color: var(--text-secondary);
        }
        
        .product-list {
            list-style: none;
            padding: 0;
            margin: 0 0 0 20px;
        }
        
        .product-list li {
            margin-bottom: 15px;
            transition: transform var(--transition-speed);
        }
        
        .product-list li:hover {
            transform: translateX(5px);
        }
        
        .product-list a {
            text-decoration: none;
            color: var(--text-secondary);
            transition: color var(--transition-speed);
            display: block;
            font-size: 1.1rem;
            padding-left: 10px;
            border-left: 2px solid transparent;
        }
        
        .product-list a:hover {
            color: var(--accent-color);
            border-left: 2px solid var(--accent-color);
        }
        
        .product-list a.active {
            font-weight: bold;
            color: var(--accent-color);
            border-left: 2px solid var(--accent-color);
        }
        
        .secondary-product {
            text-align: right;
            margin-top: -60px;
            margin-bottom: 40px;
        }
        
        .secondary-product a {
            text-decoration: none;
            color: var(--text-secondary);
            font-size: 1.6rem;
            transition: all var(--transition-speed);
        }
        
        .secondary-product a:hover {
            color: var(--accent-color);
        }
        
        /* Doc content */
        .doc-content {
            margin-top: 60px;
            border-top: 1px solid var(--border-color);
            padding-top: 30px;
            min-height: 400px;
        }
        
        /* Product content sections */
        .product-content {
            display: none; /* Hide all content sections by default */
        }
        
        .product-content.active {
            display: block; /* Show only the active content */
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .product-content h2 {
            color: var(--accent-color);
            font-size: 2rem;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }
        
        .product-content h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: var(--accent-color);
        }
        
        .product-content h3 {
            color: var(--text-primary);
            font-size: 1.5rem;
            margin: 30px 0 15px;
            position: relative;
        }
        
        .product-content p {
            margin-bottom: 20px;
            line-height: 1.7;
        }
        
        .product-content ul {
            margin-bottom: 20px;
            padding-left: 20px;
        }
        
        .product-content li {
            margin-bottom: 10px;
            position: relative;
        }
        
        /* Documentation edit placeholders */
        .doc-edit-area {
            margin: 20px 0;
            padding: 20px;
            border: 1px dashed var(--border-color);
            border-radius: 5px;
            background-color: var(--dark-bg-lightest);
            transition: all var(--transition-speed);
        }
        
        .doc-edit-area:hover {
            border-color: var(--accent-color);
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.1);
        }
        
        .doc-edit-area p {
            color: var(--text-muted);
            font-style: italic;
        }
        
        /* Documentation styling */
        .doc-section {
            margin-bottom: 40px;
            padding-bottom: 20px;
            position: relative;
        }
        
        .doc-section h3 {
            color: var(--text-primary);
            font-size: 1.6rem;
            margin: 30px 0 15px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            position: relative;
        }
        
        .doc-section h3::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 40px;
            height: 2px;
            background-color: var(--accent-color);
        }
        
        .doc-section h4 {
            color: var(--accent-color);
            font-size: 1.3rem;
            margin: 25px 0 10px;
        }
        
        .doc-section p {
            margin: 15px 0;
            line-height: 1.7;
        }
        
        .doc-section strong {
            color: var(--accent-color);
            font-weight: 600;
        }
        
        .doc-section em {
            font-style: italic;
            color: var(--text-secondary);
        }
        
        .doc-section ul {
            margin: 15px 0;
            padding-left: 25px;
            list-style-type: none;
        }
        
        .doc-section ul li {
            margin-bottom: 8px;
            position: relative;
            padding-left: 20px;
        }
        
        .doc-section ul li::before {
            content: 'â€¢';
            color: var(--accent-color);
            position: absolute;
            left: 0;
            font-size: 1.2rem;
        }
        
        .doc-section img {
            max-width: 100%;
            margin: 20px 0;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            transition: all var(--transition-speed);
        }
        
        .doc-section img:hover {
            border-color: var(--accent-color);
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.2);
        }
        
        .doc-section .highlight {
            color: var(--accent-color);
        }
        
        .doc-section .note {
            background-color: var(--dark-bg-lightest);
            border-left: 4px solid var(--accent-color);
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
        }
        
        .doc-section .warning {
            background-color: var(--dark-bg-lightest);
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
        }
        
        .doc-section .parameter {
            margin-bottom: 25px;
            padding: 15px;
            background-color: var(--dark-bg-lightest);
            border-radius: 5px;
            border-left: 3px solid var(--accent-color);
            transition: all var(--transition-speed);
        }
        
        .doc-section .parameter:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .doc-section .parameter-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-color);
            font-size: 1.1rem;
        }
        
        .doc-section .parameter-range {
            color: var(--text-secondary);
            font-style: italic;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .doc-section .parameter-description {
            margin-left: 0;
            color: var(--text-primary);
        }
        
        .doc-section .page-number {
            text-align: right;
            color: var(--text-muted);
            margin-top: 40px;
            font-size: 0.9rem;
        }
        
        .doc-section .image-caption {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        /* Modern Table of Contents */
        .toc-section {
            margin-bottom: 40px;
            padding: 20px;
            background-color: var(--dark-bg-lightest);
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .toc-section h3 {
            color: var(--accent-color);
            border-bottom: none;
            margin-top: 0;
            padding-bottom: 15px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .toc-section h3::after {
            display: none;
        }
        
        .toc-section h3::before {
            content: '\f02e';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            margin-right: 10px;
            color: var(--accent-color);
        }
        
        .toc-section ul {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 10px;
            margin: 0;
            padding: 0;
        }
        
        .toc-section li {
            padding: 0;
            margin: 0;
        }
        
        .toc-section li::before {
            display: none;
        }
        
        .toc-section a {
            display: block;
            padding: 10px 15px;
            text-decoration: none;
            color: var(--text-primary);
            background-color: var(--dark-bg);
            border-radius: 5px;
            border-left: 3px solid transparent;
            transition: all var(--transition-speed);
            position: relative;
            overflow: hidden;
        }
        
        .toc-section a::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background-color: var(--accent-color);
            transform: scaleY(0);
            transition: transform var(--transition-speed);
        }
        
        .toc-section a:hover {
            background-color: rgba(255, 193, 7, 0.1);
            transform: translateX(5px);
        }
        
        .toc-section a:hover::before {
            transform: scaleY(1);
        }
        
        .toc-section a::after {
            content: '\f054';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 0.8rem;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-color);
            opacity: 0;
            transition: opacity var(--transition-speed);
        }
        
        .toc-section a:hover::after {
            opacity: 1;
        }
        
        /* Buttons and interactive elements */
        .btn {
            display: inline-block;
            background-color: var(--dark-bg-lightest);
            color: var(--text-primary);
            padding: 8px 15px;
            border-radius: 4px;
            text-decoration: none;
            transition: all var(--transition-speed);
            border: 1px solid var(--border-color);
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .btn:hover {
            background-color: var(--accent-color);
            color: var(--dark-bg);
        }
        
        .btn-primary {
            background-color: var(--accent-color);
            color: var(--dark-bg);
            border: 1px solid var(--accent-color);
        }
        
        .btn-primary:hover {
            background-color: var(--mach1-yellow-dark);
        }
        
        /* Mobile adjustments */
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            
            .toc-sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            
            .toc-sidebar {
                height: auto;
                max-height: 300px;
                overflow-y: auto;
                border-bottom: 1px solid var(--border-color);
            }
            
            .secondary-product {
                margin-top: 20px;
                text-align: left;
            }
            
            .toc-section ul {
                grid-template-columns: 1fr;
            }
        }
        
        /* Add styling for subsections */
        .doc-subsection {
            margin: 25px 0 20px;
            padding-left: 15px;
            border-left: 2px solid var(--border-color);
        }
        
        .doc-subsection h4 {
            color: var(--accent-color);
            font-size: 1.2rem;
            margin: 15px 0 10px;
        }
        
        /* Mobile adjustments - improve responsive behavior */
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            
            .toc-sidebar {
                position: relative;
                width: 100%;
                height: auto;
                max-height: 300px;
                overflow-y: auto;
                border-bottom: 1px solid var(--border-color);
                left: 0;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .secondary-product {
                margin-top: 20px;
                text-align: left;
            }
            
            .toc-section ul {
                grid-template-columns: 1fr;
            }
            
            /* Make product title and list more readable on mobile */
            .product-title {
                font-size: 1.5rem;
            }
            
            .product-list {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                margin: 15px 0;
            }
            
            .product-list li {
                margin-bottom: 5px;
            }
            
            .product-list a {
                font-size: 0.95rem;
                padding: 5px 10px;
                background-color: var(--dark-bg-lightest);
                border-radius: 4px;
                border-left: none;
            }
            
            .product-list a.active {
                background-color: var(--accent-color);
                color: var(--dark-bg);
            }
        }
        
        /* Add specific styling for documentation images */
        .doc-image {
            display: block;
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--dark-bg-lightest);
        }
        
        .image-container {
            margin: 20px 0;
            text-align: center;
        }

        .area {
            background:#fff;
            display:block;
            height:475px;
            opacity:0;
            position:absolute;
            width:320px;
        }
        #area2 {
            left:320px;
        }
        #area1:hover, #area2:hover {
            opacity:0.2;
        }

        /* New tooltip styles */
        .tooltip-area {
            position: absolute;
            z-index: 10;
            border: 2px solid transparent;
            transition: border-color 0.3s;
            text-decoration: none;
            display: block;
        }

        /* Cursor styles based on whether area is clickable */
        .tooltip-area[href] {
            cursor: pointer;
        }

        .tooltip-area:not([href]) {
            cursor: help;
        }

        .tooltip-area:hover {
            border-color: var(--accent-color);
        }

        .tooltip-area::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background-color: var(--dark-bg-lightest);
            color: var(--text-primary);
            border: 1px solid var(--accent-color);
            border-radius: 4px;
            font-size: 0.9rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            pointer-events: none;
        }

        .tooltip-area:hover::after {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="sidebar" class="toc-sidebar active">
            <div class="toc-sidebar-inner">
                <h3>Documentation</h3>
                <ul>
                    <li class="has-submenu">
                        <a href="#panner">Mach1 Panner</a>
                        <ul>
                            <li><a href="#panner-description">Description & User Story</a>
                                <ul>
                                    <li><a href="#panner-spatial-format">Mach1 Spatial Format Explained</a></li>
                                    <li><a href="#panner-encoding">Encoding Explained</a></li>
                                </ul>
                            </li>
                            <li><a href="#panner-features">Plugin Features</a>
                                <ul>
                                    <li><a href="#panner-general-params">General Parameters</a></li>
                                    <li><a href="#panner-stereo-params">Stereo Parameters</a></li>
                                    <li><a href="#panner-quad-params">Quad Parameters</a></li>
                                </ul>
                            </li>
                            <li><a href="#panner-notes">Notes</a>
                            <li><a href="#panner-upcoming">Upcoming Features</a>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#monitor">Mach1 Monitor</a>
                        <ul>
                            <li><a href="#description">Description & User Story</a>
                                <ul>
                                    <li><a href="#spatial-format">Mach1 Spatial Format Explained</a></li>
                                    <li><a href="#decoding">Decoding Explained</a></li>
                                </ul>
                            </li>
                            <li><a href="#headlocked">Headlocked/Static Stereo</a></li>
                            <li><a href="#plugin-features">Plugin Features</a>
                                <ul>
                                    <li><a href="#general-parameters">General Parameters</a></li>
                                    <li><a href="#settings">Settings</a></li>
                                    <li><a href="#monitor-modes">Monitor Modes</a></li>
                                    <li><a href="#timecode-offset">Timecode Offset</a></li>
                                </ul>
                            </li>
                            <li><a href="#upcoming-features">Upcoming Features</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#player">Mach1 Player</a>
                        <ul>
                            <li><a href="#player-overview">Overview</a></li>
                            <li><a href="#player-features">Features</a></li>
                            <li><a href="#player-playback">Playback</a>
                                <ul>
                                    <li><a href="#player-getting-started">Getting Started</a></li>
                                    <li><a href="#player-playback">Playback Options</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#transcoder">Mach1 Transcoder</a>
                        <ul>
                            <li><a href="#transcoder-description">Description & User Story</a>
                                <ul>
                                    <li><a href="#transcoder-spatial-format">Mach1 Spatial Format</a></li>
                                    <li><a href="#transcoder-explained">Transcoder Explained</a></li>
                                    <li><a href="#transcoder-conversion">Format Conversion</a></li>
                                    <li><a href="#transcoder-headlocked">Headlocked/Static Stereo</a></li>
                                </ul>
                            </li>
                            <li><a href="#transcoder-features">Transcoding Features</a>
                                <ul>
                                    <li><a href="#transcoder-input">Input Options</a></li>
                                    <li><a href="#transcoder-output">Output Types</a></li>
                                    <li><a href="#transcoder-additional">Additional Features</a></li>
                                </ul>
                            </li>
                            <li><a href="#transcoder-upcoming">Upcoming Features</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#guide">User Guide</a>
                        <ul>
                            <li><a href="#guide-multichannel">Mach1 Spatial Multichannel Layouts</a>
                                <ul>
                                    <li><a href="#guide-format-description">Format Description & User Story</a></li>
                                    <li><a href="#guide-spatial">Mach1 Spatial</a></li>
                                    <li><a href="#guide-deliverable">Multichannel Deliverable</a></li>
                                </ul>
                            </li>
                            <li><a href="#guide-tools">Mach1 Spatial System Tools</a>
                                <ul>
                                    <li><a href="#guide-general-params">General Parameters</a></li>
                                    <li><a href="#guide-panner">Mach1 Panner (M1-Panner)</a></li>
                                    <li><a href="#guide-monitor">Mach1 Monitor (M1-Monitor)</a></li>
                                    <li><a href="#guide-transcoder">Mach1 Transcoder (M1-Transcoder)</a></li>
                                    <li><a href="#guide-player">Mach1 Player (M1-Player)</a></li>
                                </ul>
                            </li>
                            <li><a href="#guide-deployment">Game Engine Deployment</a>
                                <ul>
                                    <li><a href="#guide-unreal">Unreal Engine</a></li>
                                    <li><a href="#guide-unity">Unity</a></li>
                                    <li><a href="#guide-wwise">Wwise</a></li>
                                </ul>
                            </li>
                            <li><a href="#guide-sdk">M1 Spatial SDK Integration</a></li>
                            <li><a href="#guide-hacker">Mach1 Spatial System Hacker Help</a>
                                <ul>
                                    <li><a href="#guide-udp">UDP/OSC Ports</a></li>
                                    <li><a href="#guide-orientation">Orientation OSC Data</a></li>
                                    <li><a href="#guide-other-ports">Other UDP/OSC Ports</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- Main content area -->
        <div class="main-content">
            <!-- Product sections -->
            <div class="product-section">
                <h1 class="product-title">Mach1 Spatial System<span class="tm">â„¢</span></h1>
                <ul class="product-list">
                    <li><a href="#panner">Mach1 Panner</a></li>
                    <li><a href="#monitor">Mach1 Monitor</a></li>
                    <li><a href="#player">Mach1 Player</a></li>
                    <li><a href="#transcoder">Mach1 Transcoder</a></li>
                    <li><a href="#guide">User Guide</a></li>
                </ul>
            </div>
            
            <!-- Documentation content area -->
            <div class="doc-content">
                <!-- Panner Documentation -->
                <div id="panner-content" class="product-content">
                    <h2>Mach1 Panner</h2>
                    <p>The Mach1 Panner is a spatial audio authoring tool that allows you to position audio sources in a three-dimensional space.</p>

                    <div style="display: flex; align-items: flex-start; gap: 20px; margin: 20px 0;">
                        <div style="position: relative; flex: 0 0 600px;">
                            <img src="./panner-images/m1-panner.jpg" alt="Mach1 Panner Interface" style="width: 100%; height: auto;">
                            <a href="#panner-general-params" class="tooltip-area" 
                                 style="position: absolute; left: 2%; top: 63%; width: 70%; height: 15%;" 
                                 data-tooltip="Control panel: X, Y, Z, Diverge, and Rotation parameters">
                            </a>
                            <div class="tooltip-area" 
                                 style="position: absolute; left: 75%; top: 7%; width: 23%; height: 54%;" 
                                 data-tooltip="Gain Monitors: Visual feedback for input levels">
                            </div>
                            <div class="tooltip-area" 
                                 style="position: absolute; left: 31%; top: 95%; width: 40%; height: 4%;" 
                                 data-tooltip="Change input and output modes.">
                            </div>
                        </div>
                        <div style="
                            flex: 0 0 200px;
                            background-color: var(--dark-bg-lightest);
                            border: 1px solid var(--accent-color);
                            border-radius: 4px;
                            padding: 15px;
                            font-size: 0.9rem;
                            align-self: center;
                        ">
                            <div style="display: flex; align-items: center; margin-bottom: 10px; color: var(--accent-color);">
                                <i class="fas fa-lightbulb" style="margin-right: 8px;"></i>
                                <strong>Interactive Guide</strong>
                            </div>
                            <p style="margin: 0; line-height: 1.5;">
                                Hover over different parts of the interface to learn more.
                                <br><br>
                                Areas with a pointing hand cursor (<span style="font-size: 1.1em;">ðŸ‘†</span>) can be clicked to navigate to their documentation.
                            </p>
                        </div>
                    </div>
                    <!-- Description Section -->
                    <div id="panner-description" class="doc-section">
                        <h3>Description & User Story</h3>
                        
                        <h4 id="panner-spatial-format">Mach1 Spatial Format Explained</h4>
                        <p>Mach1 Spatial is a VVBP (Virtual Vector Based Panning) or SPS spatial audio format that encourages users to have complete freedom with their post production mixing process by not forcing the user to use any sonic signal altering processing. The user is free to apply their own DSP/ASP to their audio during the mixing process to avoid proprietary DSP algorithms for spatial audio seen in other formats or tools. With this in mind the user is completely in control of their creative mix process and can make any decision they want whether it results in realistic spatial fields or more creative spatial sound fields.</p>
                        
                        <h4 id="panner-encoding">Encoding Explained</h4>
                        <p>The Mach1 Panner allows users to encode input audio tracks/channels in their preferred DAW (Digital Audio Workstation) to the Mach1 Spatial format. The process is a simple signal distribution process with no other DSP related effects, allowing complete 1:1 encoding into our Vector Based Panning formatâ€”Mach1 Spatial.</p>
                    </div>
                    
                    <!-- Plugin Features Section -->
                    <div id="panner-features" class="doc-section">
                        <h3>Plugin Features</h3>
                        <p>The following explains all the current possible encoding modes of the Mach1 Panner in your common DAW/Editor.</p>
                        
                        <h4 id="panner-general-params">General Parameters</h4>
                        
                        <div class="parameter">
                            <div class="parameter-title">Rotation</div>
                            <div class="parameter-range">Range: 0 â†’ 180 â†’ -180 â†’ 0 (clockwise)</div>
                            <div class="parameter-description">Rotates the input sound source(s) around central listener location. Where 0 is front facing and 180/-180 is rear facing.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Diverge</div>
                            <div class="parameter-range">Range: 100 â†’ 0 â†’ -100</div>
                            <div class="parameter-description">Moves the input sound source(s) to and from center to allow control of divergence of signal, or otherwise allowing control of distribution of how the signal spreads around listener. Where 100 is front forward on current Rotation angle, 0 is center panning or mono divergence and -100 is the inverse of current Rotation angle.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">X</div>
                            <div class="parameter-range">Range: -100 â†’ 100</div>
                            <div class="parameter-description">Moves the input sound source(s) along the up/down axis in the top down view.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Y</div>
                            <div class="parameter-range">Range: -100 â†’ 100</div>
                            <div class="parameter-description">Moves the input sound source(s) along the left/right axis in the top down view.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Z</div>
                            <div class="parameter-range">Range: -100 â†’ 100</div>
                            <div class="parameter-description">Moves the input sound source(s) along the Z axis (up/down head pitch).</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Gain</div>
                            <div class="parameter-range">Range: 0 â†’ 100</div>
                            <div class="parameter-description">Controls input gain for input sound source(s) before encoding.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Overlay</div>
                            <div class="parameter-description">Allows user to pan to picture by overlaying the reticle for a equirectangular 360 video.</div>
                        </div>
                        
                        <h4 id="panner-stereo-params">Stereo Parameters</h4>
                        <p>M1-Panner mode for stereo input channels/tracks of audio (L & R)</p>
                        
                        <div class="parameter">
                            <div class="parameter-title">Stereo Spread [S SPREAD]</div>
                            <div class="parameter-description">Add/reduce the distance between Left & Right input reticles.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Stereo Orbit Angle [S ROTATE]</div>
                            <div class="parameter-description">Rotates Left & Right reticles around center reticle axis for more creative control during mixing.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Stereo Auto Orbit [AUTO ORBIT]</div>
                            <div class="parameter-description">When active Stereo Orbit Angle will automatically adjust to point toward center of M1-Panner grid.</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Stereo Balance [S PAN]</div>
                            <div class="parameter-description">Input balance/pan between Left & Right input channels.</div>
                        </div>
                        
                        <h4 id="panner-quad-params">Quad Parameters</h4>
                        <p>M1-Panner mode for Quad input channels/tracks of audio (L, R, Ls, Rs)</p>
                        
                        <div class="image-container">
                            <img src="./panner-images/PannerQuadParams.png" alt="Mach1 Panner Quad Mode Interface" style="max-width: 500px; width: 100%;">
                        </div>
                        
                        <h4 id="a-format-params">Quad - AFormat Ambisonics</h4>
                        <div class="parameter">
                            <div class="parameter-description">M1-Panner mode for stereo input channels/tracks of audio (FLU, FRD, BLU, BRD)</div>
                        </div>
                        
                        <h4 id="b-format-params">Quad - BFormat Ambisonics</h4>
                        <div class="parameter">
                            <div class="parameter-description">M1-Panner mode for stereo input channels/tracks of audio (W, X, Y, Z ACNSN3D)</div>
                        </div>
                        
                        <h4 id="quad-general-params">Quad General Parameters</h4>
                        
                        <div class="parameter">
                            <div class="parameter-title">Quad Mode Dropdown</div>
                            <div class="parameter-description">Allows the user to change/select their 4 channel Quad mode for their audio track.</div>
                        </div>
                        
                        <h4 id="ba-format-params">BFormat & AFormat Parameters</h4>
                        
                        <div class="parameter">
                            <div class="parameter-title">AFormat</div>
                            <div class="parameter-description">Intended for A-Format ambisonic microphone arrangements setup in the:<br>
                            1: front-left-up [FLU]<br>
                            2: front-right-down [FRD]<br>
                            3: back-left-down [BLD]<br>
                            4: back-right-up [BRU]</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">BFormat</div>
                            <div class="parameter-description">Intended for ACNSN3D AmbiX B-Format 4 channel audio tracks, to encode them by reversing each pole's channel into 2 channels with one phase inverted and oriented inversely to maximize the pre-AmbiX encoded audio.</div>
                        </div>
                    </div>
                    
                    <!-- Notes Section -->
                    <div id="panner-notes" class="doc-section">
                        <h3>Notes</h3>
                        
                        <div class="note">
                            <strong>Divergence Consistency:</strong> Rotation automation in the M1-Panner is currently using a radiance focused UI system due to the ease of use for users. This sacrifices the ability to have a perfectly consistent divergence ratio of signal front/back as you rotate your source. In an upcoming update we will add a processing mode that users can select to focus on Divergence Consistency.
                        </div>
                        
                        <div class="note">
                            <strong>Pro Tools HD Automation:</strong> It is observed that Pro Tools HD by default always interpolates automation to smooth all values to only two floating points (example: 20.04 instead of 20.03997); because of this continuous performance knobs/sliders, specifically the Rotation parameter are prone to a GUI bug if you record Automation for this parameter in full rotations and play it back from the Host (Pro Tools HD). This issue can occur when recording automation that travels past 180 crossing, this is due to the value attempting to reset to -180 (or 180 if counter-clockwise).
                        </div>

                        <div class="image-container">
                            <img src="./panner-images/PannerProTools.png" alt="Automation Examples">
                        </div>
                        
                        <p>Simply un-ramp the automation to further cleanup playback of a fully rotating source:</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; max-width: 800px; margin-left: auto; margin-right: auto;">
                            <div class="image-container" style="margin: 0;">
                                <img src="./panner-images/PannerZoomedOut.png" alt="Panner Zoomed Out View" style="width: 100%; height: 300px; object-fit: contain;">
                                <p class="image-caption">Zoomed Out View</p>
                            </div>
                            <div class="image-container" style="margin: 0;">
                                <img src="./panner-images/PannerZoomedInBad.png" alt="Panner Zoomed In Bad Example" style="width: 100%; height: 300px; object-fit: contain;">
                                <p class="image-caption">Bad Example</p>
                            </div>
                            <div class="image-container" style="margin: 0;">
                                <img src="./panner-images/PannerZoomedInNeutral.png" alt="Panner Zoomed In View" style="width: 100%; height: 300px; object-fit: contain;">
                                <p class="image-caption">Zoomed In View</p>
                            </div>
                            <div class="image-container" style="margin: 0;">
                                <img src="./panner-images/PannerZoomedInGood.png" alt="Panner Zoomed In Good Example" style="width: 100%; height: 300px; object-fit: contain;">
                                <p class="image-caption">Good Example</p>
                            </div>
                        </div>
                        
                    </div>
                    
                    <!-- Upcoming Features Section -->
                    <div id="panner-upcoming" class="doc-section">
                        <h3>Upcoming Features</h3>
                        <div class="doc-edit-area">
                            <p>Add upcoming features documentation here.</p>
                        </div>
                        
                        <a href="#" class="btn btn-primary">Request Feature</a>
                        <a href="#" class="btn">Report Issue</a>
                    </div>
                </div>
                
                <!-- Monitor Documentation -->
                <div id="monitor-content" class="product-content">
                    <h2>Mach1 Monitor</h2>
                    <p>The Mach1 Monitor is a powerful tool designed for monitoring spatial audio content. It provides an intuitive interface for monitoring and validating spatial audio mixes created with the Mach1 Spatial System.</p>
                    
                    <div style="display: flex; align-items: flex-start; gap: 20px; margin: 20px 0;">
                        <div style="position: relative; flex: 0 0 600px;">
                            <img src="./monitor-images/m1-monitor.jpg" alt="Mach1 Monitor Interface" style="width: 100%; height: auto;">
                            <a href="#general-parameters" class="tooltip-area" 
                                 style="position: absolute; left: 5%; top: 2%; width: 90%; height: 45%;" 
                                 data-tooltip="Yaw dial, Pitch and Roll controls for orientation.">
                            </a>
                            <a href="#settings" class="tooltip-area" 
                                 style="position: absolute; left: 1%; top: 51%; width: 98%; height: 30%;" 
                                 data-tooltip="Settings dropdown to change timecode offset, monitor modes and devices.">
                            </a>
                            <div class="tooltip-area" 
                                 style="position: absolute; left: 47%; top: 93%; width: 27%; height: 6%;" 
                                 data-tooltip="Decode selection Mach1-Spatial 8 or 4">
                            </div>
                        </div>
                        <div style="
                            flex: 0 0 200px;
                            background-color: var(--dark-bg-lightest);
                            border: 1px solid var(--accent-color);
                            border-radius: 4px;
                            padding: 15px;
                            font-size: 0.9rem;
                            align-self: center;
                        ">
                            <div style="display: flex; align-items: center; margin-bottom: 10px; color: var(--accent-color);">
                                <i class="fas fa-lightbulb" style="margin-right: 8px;"></i>
                                <strong>Interactive Guide</strong>
                            </div>
                            <p style="margin: 0; line-height: 1.5;">
                                Hover over different parts of the interface to learn more.
                                <br><br>
                                Areas with a pointing hand cursor (<span style="font-size: 1.1em;">ðŸ‘†</span>) can be clicked to navigate to their documentation.
                            </p>
                        </div>
                    </div>

                    <!-- Description Section -->
                    <div id="description" class="doc-section">
                        <h3>Description & User Story</h3>
                        <h4 id="spatial-format">Mach1 Spatial Format Explained</h4>
                        <p>Mach1 Spatial is a VVBP (Virtual Vector Based Panning) or SPS spatial audio format that encourages users to have complete freedom with their post production mixing process by not forcing the user to use any sonic signal altering processing. The user is free to apply their own DSP/ASP to their audio during the mixing process to avoid proprietary DSP algorithms for spatial audio seen in other formats or tools. With this in mind the user is completely in control of their creative mix process and can make any decision they want whether it results in realistic spatial fields or more creative spatial sound fields.</p>
                        
                        <h4 id="decoding">Decoding Explained</h4>
                        <p>The Mach1 Monitor allows users to preview and monitor the mix as though you were head tracking in your target device/app/project. The audio outputting from the channel containing Mach1 Monitor is not intended for exporting (unless using the <strong>StereoSafe mode</strong>) and is only intended for aiding in the process of mixing and mastering your spatial audio mix. This process takes the multichannel of Mach1 Spatial and down mixes them with our Mach1 Spatial VVBP algorithm to output the correct stereo image based on your simulated orientation angles (Yaw, Pitch, Roll).</p>
                        
                        <div class="image-container">
                            <img src="./monitor-images/Monitor.png" alt="Mach1 Monitor Interface">
                            <p class="image-caption">Mach1 Monitor Interface</p>
                        </div>
                    </div>

                    <!-- Headlocked Section -->
                    <div id="headlocked" class="doc-section">
                        <h3>Headlocked/Static Stereo</h3>
                        <p>Stereo audio that is intended to be headlocked or static (example: music mix) should not be processed by the Mach1 Monitor and instead should be in a buss/track that sums with the output of Mach1 Monitor for the correct mixing reference.</p>
                        
                        <div class="note">
                            <strong>Note:</strong> This is an important consideration when working with mixed spatial and traditional stereo content in your project.
                        </div>
                    </div>

                    <!-- Plugin Features Section -->
                    <div id="plugin-features" class="doc-section">
                        <h3>Plugin Features</h3>
                        <p>The following explains all the current possible encoding modes of the Mach1 Monitor in your common DAW/Editor.</p>
                        
                        <h4 id="general-parameters">General Parameters</h4>
                        
                        <div class="parameter">
                            <div class="parameter-title">Yaw</div>
                            <div class="parameter-range">Range: 0 â†’ 360 (clockwise)</div>
                            <div class="parameter-description">Allows users to simulate head-tracking on the yaw axis (rotating head horizontally)</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Pitch</div>
                            <div class="parameter-range">Range: -90 â†’ 90 (bottom to top)</div>
                            <div class="parameter-description">Allows users to simulate head-tracking on the pitch axis (nodding head up/down)</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Roll</div>
                            <div class="parameter-range">Range: -90 â†’ 90 (top of head to left â†’ top of head to right)</div>
                            <div class="parameter-description">Allows users to simulate head-tracking on the roll axis (tilting head toward a shoulder)</div>
                        </div>
                        
                        <div id="settings" class="doc-subsection">
                            <h4>Settings</h4>
                            <p>When activated allows access to more advanced features during the Mach1 Spatial mixing process, de-activate to shrink UI window size when not needed</p>
                        </div>
                        
                        <div id="monitor-modes" class="doc-subsection">
                            <h4>Monitor Modes</h4>
                            <p>Allows different decoding modes, these modes will be described on the next page</p>
                            
                            <ul>
                                <li><strong>Mach1 Spatial Mode:</strong> The default mode for full Mach1Spatial mixing support and full Yaw/Pitch/Roll controls of the M1-Monitor.</li>
                                <li><strong>StereoSafe Mode:</strong> When this mode is enabled all Panner's process audio with Mono output so that the user can quickly export a stereo version that is spatially safe in all directions for 360 audio/video players that do not support spatial audio yet. The Diverge values during the mix are instead used to correct the gain ratio between all spatial components so that the mix is roughly retained to avoid full re-mix scenarios.</li>
                                <li><strong>Front/Back FoldDown:</strong> When enabled this mode sums channels Front/Back/Top/Bottom left channels together and Front/Back/Top/Bottom right channels together to allow the user to quickly reference any front to rear differences during the mix.</li>
                            </ul>
                        </div>
                        
                        <div id="timecode-offset" class="doc-subsection">
                            <h4>Timecode Offset</h4>
                            <p>Allows the user to add offset to the Mach1 Player (M1-Player) to correctly align the video on our video player to match the video's sequence start time on your DAW</p>
                        </div>
                    </div>

                    <!-- Upcoming Features Section -->
                    <div id="upcoming-features" class="doc-section">
                        <h3>Upcoming Features</h3>
                        <div class="doc-edit-area">
                            <p>Add upcoming features documentation here.</p>
                        </div>
                        
                        <a href="#" class="btn btn-primary">Request Feature</a>
                        <a href="#" class="btn">Report Issue</a>
                    </div>
                </div>
                
                <!-- Player Documentation -->
                <div id="player-content" class="product-content">
                    <h2>Mach1 Player</h2>
                    <p>The Mach1 Player is designed for playback of spatial audio content created with the Mach1 Spatial System.</p>
                    
                    <div id="player-overview" class="doc-section">
                        <h3>Overview</h3>
                        <div class="doc-edit-area">
                            <p>Add Mach1 Player overview documentation here.</p>
                        </div>
                    </div>
                    
                    <div id="player-features" class="doc-section">
                        <h3>Features</h3>
                        <div class="doc-edit-area">
                            <p>Add Mach1 Player features documentation here.</p>
                        </div>
                    </div>
                    
                    <div id="player-getting-started" class="doc-section">
                        <h3>Getting Started</h3>
                        <div class="doc-edit-area">
                            <p>Add Mach1 Player getting started guide here.</p>
                        </div>
                    </div>
                    
                    <div id="player-playback" class="doc-section">
                        <h3>Playback Options</h3>
                        <div class="doc-edit-area">
                            <p>Add Mach1 Player playback options documentation here.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Transcoder Documentation -->
                <div id="transcoder-content" class="product-content">
                    <h2>Mach1 Transcoder</h2>
                    <p>The Mach1 Transcoder enables conversion between different spatial audio formats and the Mach1 Spatial System.</p>
                    
                    <div style="display: flex; align-items: flex-start; gap: 20px; margin: 20px 0;">
                        <div style="position: relative; flex: 0 0 600px;">
                            <img src="./transcoder-images/m1-transcoder.jpg" alt="Mach1 Transcoder Interface" style="width: 100%; height: auto;">
                            <a href="#transcoder-input" class="tooltip-area" 
                                 style="position: absolute; left: 2%; top: 10%; width: 97%; height: 45%;" 
                                 data-tooltip="Input options: Drop or load Mach1 Spatial, Static Stereo, JSON, or Video files">
                            </a>
                            <a href="#transcoder-output" class="tooltip-area" 
                                 style="position: absolute; left: 2%; top: 61%; width: 97%; height: 23%;" 
                                 data-tooltip="Output options: Select spatial format and output file type">
                            </a>
                        </div>
                        <div style="
                            flex: 0 0 200px;
                            background-color: var(--dark-bg-lightest);
                            border: 1px solid var(--accent-color);
                            border-radius: 4px;
                            padding: 15px;
                            font-size: 0.9rem;
                            align-self: center;
                        ">
                            <div style="display: flex; align-items: center; margin-bottom: 10px; color: var(--accent-color);">
                                <i class="fas fa-lightbulb" style="margin-right: 8px;"></i>
                                <strong>Interactive Guide</strong>
                            </div>
                            <p style="margin: 0; line-height: 1.5;">
                                Hover over different parts of the interface to learn more.
                                <br><br>
                                Areas with a pointing hand cursor (<span style="font-size: 1.1em;">ðŸ‘†</span>) can be clicked to navigate to their documentation.
                            </p>
                        </div>
                    </div>

                    <!-- Description Section -->
                    <div id="transcoder-description" class="doc-section">
                        <h3>Description & User Story</h3>
                        
                        <h4 id="transcoder-spatial-format">Mach1 Spatial Format Explained</h4>
                        <p>Mach1 Spatial is a VVBP (Virtual Vector Based Panning) or SPS spatial audio format that encourages users to have complete freedom with their post production mixing process by not forcing the user to use any sonic signal altering processing. The user is free to apply their own DSP/ASP to their audio during the mixing process to avoid proprietary DSP algorithms for spatial audio seen in other formats or tools. With this in mind the user is completely in control of their creative mix process and can make any decision they want whether it results in realistic spatial fields or more creative spatial sound fields.</p>
                        
                        <h4 id="transcoder-explained">Transcoder Explained</h4>
                        <p>Mach1 Spatial as a virtual vector based format has the advantage of not using any signal processing effects for pre-rendering or playing back spatial audio. Due to this major advantage; the user is able to leverage Mach1 Spatial format as a master spatial audio format and use the Transcoder to down mix to all other spatial or surround formats without introducing any mix altering effects, guaranteeing the most 1:1 transcoding possible.</p>
                        
                        <h4 id="transcoder-conversion">Format Conversion (m1-transcode)</h4>
                        <p>The format conversion math uses basic coefficient changes to channels of audio with only the process effecting: re-ordering channels to the correct output, correctly distributing audio data to the correct output channels. There are no other effects applied to the master mix.</p>
                        <p>For more information: <a href="https://dev.mach1.tech/#mach1transcode-api" target="_blank">https://dev.mach1.tech/#mach1transcode-api</a></p>
                        
                        <h4 id="transcoder-headlocked">Headlocked/Static Stereo</h4>
                        <p>Use the Input Static Stereo Mix field to correctly mux master headlocked stereo audio, ideal for adding music or some VO elements (as well as experimental elements) to your spatial mix. These channels will remain intact until the decoding stages, at which point the target app will sum these channels to the output decoded stereo from the spatial mix (if your target app supports this).</p>
                    </div>
                    
                    <!-- Transcoding Features Section -->
                    <div id="transcoder-features" class="doc-section">
                        <h3>Transcoding Features</h3>
                        
                        <div id="transcoder-input" class="doc-subsection">
                            <h4>Input Options</h4>
                            
                            <h5>Audio</h5>
                            <div class="parameter">
                                <div class="parameter-title">Mach1 Spatial Input</div>
                                <div class="parameter-description">Single multichannel file of 8 channels exported/rendered from preferred DAW, supports aif or wav files. (automatically detects Pro Tools HD multichannel .wav file and reorder the channels correctly during transcoding process from the 7.1 channel order)</div>
                            </div>
                            
                            <div class="parameter">
                                <div class="parameter-title">Mach1 Horizon Pairs Inputs</div>
                                <div class="parameter-description">
                                    Drag in the 4 exported stereo files. Add the following to the end of the file names to safely encode:<br>
                                    <strong>_000</strong> (front)<br>
                                    <strong>_090</strong> (right)<br>
                                    <strong>_180</strong> (back)<br>
                                    <strong>_270</strong> (left)<br>
                                    The M1-Transcoder app will only display the available/relevant transcoding options for the Mach1 Horizon Pairs input type.
                                </div>
                            </div>
                            
                            <h5>Video</h5>
                            <p>Supports mp4 & mov video files, all conversions/encoding/transcodings use pass through video so that nothing is re-encoded or effecting the video streams of files.</p>
                        </div>
                        
                        <div id="transcoder-output" class="doc-subsection">
                            <h4>Output Types</h4>
                            
                            <h5>Spatial Format & File Type Allowed</h5>
                            <ul>
                                <li>Mach1 Spatial (Audio & Video)</li>
                                <li>Mach1 Horizon (Audio & Video)</li>
                                <li>Mach1 Horizon Pairs (Single Stream) (Audio & Video)</li>
                                <li>Mach1 Horizon Pairs / Quad-Binaural (Multiple Streams) (Audio & Video)</li>
                                <li>First Order Ambisonic ACNSN3D [Youtube] (Audio & Video) [Applies metadata for direct upload to Youtube depending on selected File Type]</li>
                                <li>First Order Ambisonic FuMa (Audio & Video)</li>
                                <li>Second Order Ambisonic ACNSN3D (Audio Only)</li>
                                <li>Second Order Ambisonic FuMa (Audio Only)</li>
                                <li>Third Order Ambisonic ACNSN3D (Audio Only)</li>
                                <li>Third Order Ambisonic FuMa (Audio Only)</li>
                                <li>5.0 Surround (L,C,R,Ls,Rs) (Audio & Video)</li>
                                <li>5.1 Surround (L,C,R,Ls,Rs,LFE) (Audio & Video)</li>
                                <li>5.1 Surround SMPTE (L,R,C,LFE,Ls,Rs) (Audio & Video)</li>
                                <li>5.1 Surround DTS (L,R,Ls,Rs,C,LFE) (Audio & Video)</li>
                                <li>5.0.2 Surround (L,C,R,Ls,Rs,Lts,Rts) (Audio Only)</li>
                                <li>5.1.2 Surround (L,C,R,Ls,Rs,LFE,Lts,Rts) (Audio Only)</li>
                                <li>5.0.4 Surround (L,C,R,Ls,Rs,FLts,FRts,BLts,BRts) (Audio Only)</li>
                                <li>5.1.4 Surround (L,C,R,Ls,Rs,LFE,FLts,FRts,BLts,BRts) (Audio Only)</li>
                                <li>7.0 Surround (L,C,R,Lss,Rss,Lsr,Rsr) (Audio & Video)</li>
                                <li>7.1 Surround (L,C,R,Lss,Rss,Lsr,Rsr,LFE) (Audio & Video)</li>
                                <li>7.1 Surround SDDS (L,Lc,C,Rc,R,Ls,Rs,LFE) (Audio & Video)</li>
                                <li>7.1.2 Surround (L,C,R,Lss,Rss,Lsr,Rsr,LFE,Lts,Rts) (Audio Only)</li>
                                <li>7.1.4 Surround (L,C,R,Lss,Rss,Lsr,Rsr,LFE,FLts,FRts,BLts,BRts) (Audio Only)</li>
                                <li>FB360/TBE (8ch) (Audio Only)</li>
                            </ul>
                            
                            <p>This list is maintained here: <a href="https://dev.mach1.tech/#formats-supported" target="_blank">https://dev.mach1.tech/#formats-supported</a></p>
                            
                            <h5>Output</h5>
                            <p>The output options are dependent on what is possible per selected format as the list above shows.</p>
                        </div>
                    </div>
                    <!-- Additional Features Section -->
                    <div id="transcoder-additional" class="doc-section">
                        <h3>Additional Features</h3>
                        
                        <div class="parameter">
                            <div class="parameter-title">Transcode</div>
                            <div class="parameter-description">Runs the transcoding process for the users input files to become the target output encoded audio/video (applies metadata for YouTube output if selected).</div>
                        </div>
                        
                        <div class="parameter">
                            <div class="parameter-title">Auto File Loading</div>
                            <div class="parameter-description">Drag and drop the input audio file(s) in the top half of app window and the intended video input in the bottom half of the app window to load the input files into the correct files easily.</div>
                        </div>

                        <div style="display: flex; gap: 70px; justify-content: center; margin: 20px 0;">
                            <div class="image-container" style="margin: 0;">
                                <img src="./transcoder-images/TranscoderAudioLoad.png" alt="Transcoder Audio Loading Interface" style="max-width: 500px; width: 120%;">
                                <p class="image-caption">Audio File Loading</p>
                            </div>
                            <div class="image-container" style="margin: 0;">
                                <img src="./transcoder-images/TranscoderVideoLoad.png" alt="Transcoder Video Loading Interface" style="max-width: 500px; width: 120%;">
                                <p class="image-caption">Video File Loading</p>
                            </div>
                        </div>
                        
                        <p>These features are available after a successful run of the M1-Transcoder.</p>
                        
                        <div class="parameter">
                            <div class="parameter-title">Reveal In Finder</div>
                            <div class="parameter-description">Shows user the location of the output transcoded audio/video file in Finder.</div>
                        </div>
                    </div>
                    
                    <!-- Upcoming Features Section -->
                    <div id="transcoder-upcoming" class="doc-section">
                        <h3>Upcoming Features</h3>
                        <ul>
                            <li>Utilize the M1-Player as a standalone review player for transcoded mixes and videos.</li>
                            <li>Support the FB360 metadata spec for encoding video metadata to support ingestible FB360 videos for Meta supported apps.</li>
                        </ul>
                        
                        <a href="#" class="btn btn-primary">Request Feature</a>
                        <a href="#" class="btn">Report Issue</a>
                    </div>
                </div>
                
                <!-- User Guide Documentation -->
                <div id="guide-content" class="product-content">
                    <h2>User Guide</h2>

                    <div id="guide-multichannel" class="doc-section">
                        <h3>Mach1 Spatial Multichannel Layouts</h3>
                        
                        <div id="guide-format-description" class="doc-subsection">
                            <h4>Format Description & User Story</h4>
                            <p>These layouts have been developed to preserve stereophony and allow audio professionals to mix in a spatial format that continues all mixing knowledge known for traditional stereo & surround audio mixing. Several notable features of these formats include that there is no active processing during playback for users. This allows studio environments to monitor the mix without needing to compensate for any additional possible active filters, room modeling or reverb processes added to the mix without the audio engineer able to have too much controlâ€”this is not the case with Mach1 Spatial. This also means that on the integration side of the Mach1 Spatial APIs are extremely lightweight for developers to integrate as seen fit (based on a few rough guidelines) streamlining the mixing and delivering pipeline. Lastly this means that the audio engineer is responsible for what 'spatial audio' means in their mix and has full creative control to try to make something realistic or define new rules of 'spatial audio' or even provide both in the same mix.</p>
                            
                            <p>This approach is a virtual algorithmic version of Vector Base Panning (VVBP). Contrary to object orientated audio or ambisonics designed to simulate soundfield reconstructionâ€”VVBP is designed to correctly distribute audio and take full advantage of the creation of phantom sound sources around the listener, the problem is until now this approach is only successful with an array of loudspeakers recreating physical sound. The Mach1 Spatial virtual Vector Base Panning (VVBP) allows user to pan directly to their spatial mix and not require the user to recreate an approximation of the spatial audio field during playback, all correctly down-mixed to stereo for ideal playback scenarios.</p>
                        </div>

                        <div id="guide-spatial" class="doc-subsection">
                            <h4>Mach1 Spatial</h4>
                            <p>The M1 Spatial format is designed to allow stereoscopic mixes to incorporate 3 degrees of freedom for target users. The mix correctly allows for yaw, pitch and roll movements toward the down-mixed stereo algorithm.</p>
                        </div>

                        <div id="guide-deliverable" class="doc-subsection">
                            <h4>Multichannel Deliverable</h4>
                            <p>A single multichannel file of 4, 8, 12 or 14 channels are run through the Mach1Decode API during playback to create the exact stereo image via traditional Vector Based Panning math. Prepare your multichannel mix and an additional optional head-locked stereo mix for distribution or layback to a target video via the M1-Transcoder application.</p>
                        </div>
                    </div>

                    <div id="guide-tools" class="doc-section">
                        <h3>Mach1 Spatial System Tools</h3>
                        
                        <div id="guide-general-params" class="doc-subsection">
                            <h4>General Parameters</h4>
                            <p>The Mach1 Spatial System allow automatic communication between all plugins and standalone applications. This is done via a background service "M1-System-Helper" which sets up temporary and lightweight network between all the plugins and apps during runtime. The following ports are used behind the scenes on launch of plugins and standalone applications:</p>
                            
                            <div class="parameter">
                                <div class="parameter-title">System Ports</div>
                                <div class="parameter-description">
                                    Port: 9001-9004 : 9100 : 10000-11000 : 12345<br>
                                    Ports are searched and configured on launch for these ranges on the localhost of the user's computer.
                                </div>
                            </div>
                        </div>

                        <div id="guide-panner" class="doc-subsection">
                            <h4>Mach1 Panner (M1-Panner)</h4>
                            <p>The M1-Panner is designed off of the UI of many common surround panners and is based off of a system of divergence instead of actual 3D space representation. The M1-Panner's main UI window is a top down view of the mixing environment. The concentric circles around the center give the user references to different divergence amounts. It is safe to assume that the middle circle represents the estimated divergence of the common ambisonic encoding, while pushing beyond the second concentric circle allows the user to pan sounds to isolated positions in the mix (allowing infinite creative abilities still contained in a single spatial audio mix). It is still recommended to automate your volume outside of the M1-Panner plugin to simulate distance and attenuation. The M1-Panner has a UI slider for altitude or vertical panning of that track as well.</p>
                            
                            <p>The M1-Panner changes when it is placed on a Mono, Stereo or Multichannel track (Stereo and multichannel modes still in development). When in a multichannel mode the M1-Panner operates with the same automation as the Mono mode however it introduces new functions to rotate and spread the stereo emitters further or closer to center.</p>
                            
                            <p>Click on the Overlay button to activate 2D to 3D panning window that snaps to Pro Tools native video player and translates your 2D mouse movements into 3D orientation movements. There is also the gain slider that is set to +6db default to compensate for pan law in this format.</p>
                        </div>

                        <div id="guide-monitor" class="doc-subsection">
                            <h4>Mach1 Monitor (M1-Monitor)</h4>
                            <p>The M1-Monitor adds a monitoring stage using our decoding math shared in the SDK so the user or audio engineer is able to monitor and hear their spatial audio mix during postproduction and mixing process. The M1-Monitor contains sliders for Yaw, Pitch and Roll for mouse referencing user orientation during the mix process.</p>
                            
                            <p>The M1-Monitor automatically connects with the M1-Player to receive input orientation from the M1-Player's mouse controlled orientation. Both the M1-Monitor and the M1-Player simultaneously receive orientation from any 3rd party IMU or head tracking solution supported by the background service "M1-OrientationManager". The M1-Monitor also sends transport location automatically to the M1-Player.</p>
                        </div>

                        <div id="guide-transcoder" class="doc-subsection">
                            <h4>Mach1 Transcoder (M1-Transcoder)</h4>
                            <p>This standalone application is used to safely apply/encode the user's audio mix to their video content inside of the video container. The Transcoder renders the final video needed for delivery on available platforms/apps as well as downmix the spatial audio as closely as possible to ambisonics for other deliverables.</p>
                        </div>

                        <div id="guide-player" class="doc-subsection">
                            <h4>Mach1 Player (M1-Player)</h4>
                            <p>The M1-Player allows users to simulate orientation angles in additionally beyond the Monitor. Once launched the M1-Player links to the Monitor and controls the Monitor's orientation without Keyboard Focus. Simply drag a video into the M1-Player after launch to have it load a 360 video.</p>
                            
                            <div class="parameter">
                                <div class="parameter-title">Hotkey Options</div>
                                <div class="parameter-description">
                                    <ul>
                                        <li>'Z' â€“ Switches between flatmode and spherical 360 mode</li>
                                        <li>'O' â€“ Turns on reference angle overlay image onto the video</li>
                                        <li>'D' â€“ Switches between Stereoscopic and Monoscopic videos</li>
                                        <li>'H' â€“ Hold this key to view M1-Player statistics</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="guide-deployment" class="doc-section">
                        <h3>Game Engine Deployment</h3>
                        <p>The following section is to detail on current spatial audio implementation. It goes over installation into standard projects, general use and deployment and the current features available for implementation.</p>
                        
                        <div class="note">
                            <strong>More Information:</strong> Can be found on the <a href="https://www.youtube.com/c/Mach1Spatial" target="_blank">Mach1 Spatial Youtube Channel</a>
                        </div>

                        <div id="guide-unreal" class="doc-subsection">
                            <h4>Unreal Engine</h4>
                            <h5>Mach1 Spatial Unreal Engine Plugin</h5>
                            <p>Mach1 Spatial Plugin installs classes that can be used in Unreal Engine's Editor for deploying different forms of Mach1 Spatial Audio Formats. The classes call the Mach1Decode library for each target platform/device with the following features:</p>
                            
                            <div class="parameter">
                                <div class="parameter-title">Features</div>
                                <div class="parameter-description">
                                    <ul>
                                        <li><strong>SourcePoint (Default Rotator):</strong> Allows the deployed audio/mix to rotate to a specific point in relation to the user's position/orientation. This gives positional abilities to the audio without changing anything in the deployed audio/mix.</li>
                                        <li><strong>Custom Attenuation Curves:</strong> When active the user is able to place an attenuation curve to the Actor that is relative to the users position for simulating any possible distance falloff for the deployed audio/mix desired. Use in groups to create crossfade scenarios with complete control.</li>
                                        <li><strong>SourcePoint Closest Point (Rotator Plane):</strong> When active this assigns the SourcePoint feature to a plane/wall and calculates the users closest point to that plane/wall to be used as the SourcePoint location per update/tick.</li>
                                        <li><strong>Check Yaw/Pitch:</strong> Allows the user to ignore certain orientation inputs to that deployed audio/mix.</li>
                                        <li><strong>Fade Settings:</strong> These actors have incorporated fade settings making it a clean addition to add Fade In or Fade Out settings when needed.</li>
                                        <li><strong>Custom Node Activation & Node Settings:</strong> These classes/actors can be control with Blueprint Nodes however your project may need.</li>
                                        <li><strong>Zone Interruption (Mute Inside/Outside):</strong> If the camera enters inside one of the SpatialSound's objects reference Spatial it will turn output volume to 0 for that object.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div id="guide-unity" class="doc-subsection">
                            <h4>Unity</h4>
                            <h5>Mach1 Spatial Unity Package</h5>
                            <p>Leverages Unity scripts to call functions from Mach1Decode library per target platform with the following features:</p>
                            
                            <div class="parameter">
                                <div class="parameter-title">Features</div>
                                <div class="parameter-description">
                                    <ul>
                                        <li><strong>SourcePoint (Default Rotator):</strong> Allows the deployed audio/mix to rotate to a specific point in relation to the user's position/orientation.</li>
                                        <li><strong>Custom Attenuation Curves:</strong> When active the user is able to place an attenuation curve to the object that is relative to the users position.</li>
                                        <li><strong>SourcePoint Closest Point (Rotator Plane):</strong> Assigns the SourcePoint feature to a plane/wall and calculates the users closest point.</li>
                                        <li><strong>Check Yaw/Pitch/Roll:</strong> Allows the user to ignore certain orientation inputs to that deployed audio/mix.</li>
                                        <li><strong>Zone Interruption (Mute Inside/Outside):</strong> Controls output volume based on camera position relative to SpatialSound objects.</li>
                                        <li><strong>Custom Loading:</strong> Control when to asynchronously load Mach1 audio/mixes or whether to just load on start.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div id="guide-wwise" class="doc-subsection">
                            <h4>Wwise</h4>
                            <p>Currently in development.</p>
                        </div>
                    </div>

                    <div id="guide-sdk" class="doc-section">
                        <h3>M1 Spatial SDK Integration</h3>
                        <p>Please contact info@mach1.tech if you are interested in importing the Mach1Decode API or Mach1Transcode API to your app to allow support for playing back Mach1 Spatial mixes as well as transcode and convert all spatial/surround audio formats from/to each other.</p>
                        
                        <div class="note">
                            More information about the APIs can be found in our <a href="https://dev.mach1.tech" target="_blank">Developer Documentation</a>
                        </div>
                    </div>

                    <div id="guide-hacker" class="doc-section">
                        <h3>Mach1 Spatial System Hacker Help</h3>
                        <p>As multichannel and spatial audio mixing becomes more needed, we want to enable content creators to be able to control our plugins with any device they create or any new device to market to suit their workflow and pipeline needs.</p>
                        
                        <div id="guide-udp" class="doc-subsection">
                            <h4>UDP/OSC Ports</h4>
                            <p>Control M1-Monitor or M1-Player by sending orientation data via OSCMessages or just raw UDP formatted as:</p>
                            <div class="parameter">
                                <div class="parameter-title">Format</div>
                                <div class="parameter-description">String (address), Float (yaw), Float (pitch), Float (roll)</div>
                            </div>
                            
                            <div class="note">
                                Remember to not open the device/app that would normally use this port or you will have a port conflict and see no data transmission.
                            </div>
                            
                            <div class="parameter">
                                <div class="parameter-title">Port Assignments</div>
                                <div class="parameter-description">
                                    <ul>
                                        <li>9899: BoseAR Devices sending orientation data to M1-Monitor</li>
                                        <li>9901: M1-MNTRCTRL iOS App sending orientation data to M1-Player</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div id="guide-orientation" class="doc-subsection">
                            <h4>Orientation OSC Data</h4>
                            <p>For custom orientation transmission we expect the following Euler YPR angles with the address /orientation</p>
                            
                            <div class="parameter">
                                <div class="parameter-title">Angle Ranges</div>
                                <div class="parameter-description">
                                    <ul>
                                        <li>float [0] = Yaw | 0.0 -> 360.0 | left->right ++</li>
                                        <li>float [1] = Pitch | -90.0 -> 90.0 | down->up ++</li>
                                        <li>float [2] = Roll | -90.0 -> 90.0 | left-ear-down->right-ear-down ++</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div id="guide-other-ports" class="doc-subsection">
                            <h4>Other UDP/OSC Ports</h4>
                            <div class="parameter">
                                <div class="parameter-title">Port Ranges</div>
                                <div class="parameter-description">
                                    <ul>
                                        <li>10001->10200: M1-Panner instances connecting to m1-system-helper</li>
                                        <li>10201->10300: M1-Monitor instances connecting to m1-system-helper</li>
                                        <li>10301->10300: M1-Player instances connecting to m1-system-helper</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <p>Ports are searched and configured on launch for these ranges on localhost of the user's computer and establish working on connections using unused ports within range.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Script to handle content switching and TOC navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Setup TOC accordion
            const setupTOCAccordion = function() {
                // Get all TOC sidebars
                const sidebar = document.querySelector('#sidebar');
                
                // Find all links with submenu
                const menuItems = sidebar.querySelectorAll('li');
                
                menuItems.forEach(item => {
                    const link = item.querySelector(':scope > a');
                    const subMenu = item.querySelector(':scope > ul');
                    
                    if (subMenu && link) {
                        item.classList.add('has-submenu');
                        item.classList.add('collapsed'); // Start collapsed
                        
                        // We're removing the click handler here as it's handled in the main TOC link handler
                    }
                });
                
                // Ensure all sections start collapsed on page load
                document.querySelectorAll('#sidebar .has-submenu').forEach(item => {
                    item.classList.add('collapsed');
                });
                
                // Remove active class from main navigation on page load
                document.querySelectorAll('.product-list a').forEach(link => {
                    link.classList.remove('active');
                });
                
                // Make sure no content section is active by default
                document.querySelectorAll('.product-content').forEach(content => {
                    content.classList.remove('active');
                });
            };
            
            // Call setup function
            setupTOCAccordion();
            
            // Add smooth scrolling for tooltip areas
            const tooltipAreas = document.querySelectorAll('.tooltip-area');
            tooltipAreas.forEach(area => {
                area.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        // Calculate offset with padding
                        const offset = targetElement.getBoundingClientRect().top + window.pageYOffset - 60;
                        
                        // Smooth scroll to target
                        window.scrollTo({
                            top: offset,
                            behavior: 'smooth'
                        });
                        
                        // Update URL without jumping
                        history.pushState(null, null, targetId);
                        
                        // Highlight the corresponding TOC link
                        const tocLink = document.querySelector(`.toc-sidebar a[href="${targetId}"]`);
                        if (tocLink) {
                            document.querySelectorAll('.toc-sidebar a').forEach(l => l.classList.remove('active'));
                            tocLink.classList.add('active');
                            
                            // Expand parent if in collapsed menu
                            const parentLi = tocLink.closest('li.has-submenu');
                            if (parentLi) {
                                parentLi.classList.remove('collapsed');
                            }
                        }
                    }
                });
            });

            // Get all navigation links
            const navLinks = document.querySelectorAll('.product-list a, .secondary-product a');
            
            // Get all content sections
            const contentSections = document.querySelectorAll('.product-content');
            
            // Update the sidebar reference
            const sidebar = document.querySelector('#sidebar');
            
            // Add click event listeners for product navigation
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all links
                    navLinks.forEach(l => l.classList.remove('active'));
                    
                    // Add active class to clicked link
                    this.classList.add('active');
                    
                    // Get the content ID from the href attribute
                    const contentId = this.getAttribute('href').substring(1);
                    
                    // Hide all content sections
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show the selected content section
                    document.getElementById(contentId + '-content').classList.add('active');
                    
                    // Find and expand the corresponding TOC section
                    const sectionLink = document.querySelector(`#sidebar .has-submenu > a[href="#${contentId}"]`);
                    if (sectionLink) {
                        // Collapse all TOC sections first
                        document.querySelectorAll('#sidebar .has-submenu').forEach(item => {
                            item.classList.add('collapsed');
                        });
                        
                        // Expand the selected section
                        const parentLi = sectionLink.closest('.has-submenu');
                        if (parentLi) {
                            parentLi.classList.remove('collapsed');
                        }
                    }
                    
                    // Reset scroll position for the selected content
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            });
            
            // Variable to track what link was last clicked
            let userClickedLink = null;
            let clickTimestamp = 0;
            
            // Improved smooth scrolling for TOC sidebar links
            const tocLinks = document.querySelectorAll('.toc-sidebar a');
            tocLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    // Check if this is a parent menu item with submenu
                    const isSubmenuParent = link.parentElement.classList.contains('has-submenu');
                    
                    if (isSubmenuParent) {
                        // Find the direct parent li of the clicked link
                        const parentLi = link.parentElement;
                        
                        // Get the href of the clicked link
                        const linkHref = link.getAttribute('href');
                        
                        // Check if this is a top-level menu item (direct child of the main ul)
                        const isTopLevel = parentLi.parentNode.parentNode.classList.contains('toc-sidebar-inner');
                        
                        // If it's a top-level accordion header
                        if (isTopLevel) {
                            // First collapse all top-level accordions
                            document.querySelectorAll('.toc-sidebar > .toc-sidebar-inner > ul > li.has-submenu').forEach(item => {
                                item.classList.add('collapsed');
                            });
                            
                            // Then expand only the clicked one
                            parentLi.classList.remove('collapsed');
                        } else {
                            // For non top-level items, just toggle as before
                            parentLi.classList.toggle('collapsed');
                        }
                        
                        // For any parent with submenu, prevent navigation if it has child elements
                        const hasChildSubmenu = parentLi.querySelector('ul') !== null;
                        if (hasChildSubmenu) {
                            return; // Don't navigate, just toggle
                        }
                    }
                    
                    // Only navigate if there's a target element
                    if (targetElement) {
                        // Store which link was clicked and when
                        userClickedLink = this;
                        clickTimestamp = Date.now();
                        
                        // Make the corresponding product section active
                        const productId = getProductIdFromLink(link);
                        if (productId) {
                            const targetProduct = document.getElementById(productId + '-content');
                            if (targetProduct) {
                                // Update main content section
                                document.querySelectorAll('.product-content').forEach(content => {
                                    content.classList.remove('active');
                                });
                                targetProduct.classList.add('active');
                                
                                // Update main navigation
                                navLinks.forEach(navLink => {
                                    navLink.classList.remove('active');
                                    if (navLink.getAttribute('href') === '#' + productId) {
                                        navLink.classList.add('active');
                                    }
                                });
                            }
                        }
                        
                        // Calculate the scroll offset with some padding
                        const offset = targetElement.getBoundingClientRect().top + window.pageYOffset - 60;
                        
                        // Scroll to the target element with smooth behavior
                        window.scrollTo({
                            top: offset,
                            behavior: 'smooth'
                        });
                        
                        // Add active class to the clicked link
                        tocLinks.forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Update URL hash for better navigation history
                        history.pushState(null, null, targetId);
                        
                        // Expand all parent accordions
                        let parent = link.closest('li.has-submenu');
                        while (parent) {
                            parent.classList.remove('collapsed');
                            parent = parent.parentElement.closest('li.has-submenu');
                        }
                    }
                });
            });
            
            // More accurate detection of elements in viewport
            function isElementInViewport(el) {
                const rect = el.getBoundingClientRect();
                const windowHeight = window.innerHeight || document.documentElement.clientHeight;
                const headerOffset = 100; // Account for header/navigation
                
                // Calculate how much of the element is visible
                const visibleHeight = Math.min(rect.bottom, windowHeight) - Math.max(rect.top, headerOffset);
                const elementVisibleRatio = visibleHeight / rect.height;
                
                // Check if element is entering from top of viewport
                const isEnteringTop = rect.top >= headerOffset && rect.top <= windowHeight * 0.5;
                
                // Check if element takes significant portion of the viewport
                const isSignificantPortion = visibleHeight > 100 && elementVisibleRatio > 0.3;
                
                // Check if element's top is close to the top of the viewport
                const isNearTop = rect.top >= -150 && rect.top <= windowHeight * 0.3;
                
                return isEnteringTop || isSignificantPortion || isNearTop;
            }
            
            // Enhanced section highlighting based on scroll position
            const highlightCurrentSection = function() {
                // Skip if a user just clicked a link (within last 3 seconds)
                if (userClickedLink && (Date.now() - clickTimestamp) < 3000) {
                    return;
                }
                
                // Get the active product content
                const activeProduct = document.querySelector('.product-content.active');
                if (!activeProduct) return;
                
                // Get all main sections and subsections with IDs
                const mainSections = activeProduct.querySelectorAll('.doc-section');
                const subSections = activeProduct.querySelectorAll('.doc-subsection[id], h4[id]');
                
                // Check which elements are currently visible
                let visibleElements = [];
                
                // First check subsections (they have priority if visible)
                subSections.forEach(section => {
                    if (isElementInViewport(section)) {
                        visibleElements.push({
                            id: section.id,
                            element: section,
                            top: section.getBoundingClientRect().top,
                            isSubsection: true
                        });
                    }
                });
                
                // If no subsections visible, check main sections
                if (visibleElements.length === 0) {
                    mainSections.forEach(section => {
                        if (isElementInViewport(section)) {
                            visibleElements.push({
                                id: section.id,
                                element: section,
                                top: section.getBoundingClientRect().top,
                                isSubsection: false
                            });
                        }
                    });
                }
                
                // Sort by position (top to bottom)
                visibleElements.sort((a, b) => a.top - b.top);
                
                // Find the topmost visible element
                let currentElementId = null;
                if (visibleElements.length > 0) {
                    // Prefer elements at the top of the viewport
                    for (let i = 0; i < visibleElements.length; i++) {
                        if (visibleElements[i].top >= -100) { // Just below the top of viewport
                            currentElementId = visibleElements[i].id;
                            break;
                        }
                    }
                    
                    // If no preferred element found, use the first visible one
                    if (!currentElementId && visibleElements.length > 0) {
                        currentElementId = visibleElements[0].id;
                    }
                }
                
                if (currentElementId) {
                    // Remove active class from all TOC links
                    tocLinks.forEach(link => {
                        link.classList.remove('active');
                    });
                    
                    // Add active class to the TOC link for the current element
                    const activeTocLink = document.querySelector(`#sidebar a[href="#${currentElementId}"]`);
                    if (activeTocLink) {
                        activeTocLink.classList.add('active');
                        
                        // Expand accordion for the active link
                        expandActiveAccordion();
                    }
                }
            };
            
            // Throttle the scroll event to improve performance
            let scrollTimer;
            window.addEventListener('scroll', function() {
                clearTimeout(scrollTimer);
                scrollTimer = setTimeout(highlightCurrentSection, 50); // Reduced from 100ms to 50ms for faster response
            });
            
            // Also trigger highlight on window resize as this can change what's in viewport
            window.addEventListener('resize', function() {
                clearTimeout(scrollTimer);
                scrollTimer = setTimeout(highlightCurrentSection, 100);
            });
            
            // Function to expand parent accordions of an active link
            const expandActiveAccordion = function() {
                const activeLink = document.querySelector('#sidebar a.active');
                if (!activeLink) return;
                
                // Find all parent accordions and expand them
                let parent = activeLink.closest('li.has-submenu');
                while (parent) {
                    parent.classList.remove('collapsed');
                    parent = parent.parentElement.closest('li.has-submenu');
                }
                
                // Determine which main section this belongs to
                const productId = getProductIdFromLink(activeLink);
                if (productId) {
                    // Make that product content active if it's not already
                    const activeProduct = document.querySelector('.product-content.active');
                    const targetProduct = document.getElementById(productId + '-content');
                    
                    if (activeProduct !== targetProduct && targetProduct) {
                        document.querySelectorAll('.product-content').forEach(content => {
                            content.classList.remove('active');
                        });
                        targetProduct.classList.add('active');
                        
                        // Also update the main navigation
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + productId) {
                                link.classList.add('active');
                            }
                        });
                    }
                }
            };
            
            // Helper function to get product ID from a TOC link
            function getProductIdFromLink(link) {
                // Look at parent .has-submenu elements to find the top-level one
                let topParent = link.closest('li.has-submenu');
                
                while (topParent && topParent.parentElement && 
                       topParent.parentElement.closest('li.has-submenu')) {
                    topParent = topParent.parentElement.closest('li.has-submenu');
                }
                
                if (topParent) {
                    const topLink = topParent.querySelector(':scope > a');
                    if (topLink) {
                        const href = topLink.getAttribute('href');
                        if (href && href.startsWith('#')) {
                            return href.substring(1);
                        }
                    }
                }
                
                return null;
            }
            
            // Initial highlighting on page load
            highlightCurrentSection();
            
            // Expand accordion sections for the active link
            expandActiveAccordion();
            
            // Handle hash navigation on page load
            if (window.location.hash) {
                const targetId = window.location.hash;
                const targetElement = document.querySelector(targetId);
                
                if (targetElement) {
                    // Wait a short time to ensure page layout is complete
                    setTimeout(() => {
                        const offset = targetElement.getBoundingClientRect().top + window.pageYOffset - 60;
                        window.scrollTo({
                            top: offset,
                            behavior: 'smooth'
                        });
                        
                        // Find and highlight the correct TOC link
                        const tocLink = document.querySelector(`.toc-sidebar a[href="${targetId}"]`);
                        if (tocLink) {
                            tocLinks.forEach(l => l.classList.remove('active'));
                            tocLink.classList.add('active');
                            
                            // Expand parent accordions
                            expandActiveAccordion();
                        }
                    }, 300);
                }
            }
        });
    </script>
</body>
</html>